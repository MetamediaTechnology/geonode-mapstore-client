(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[97909],{807472:(e,t,r)=>{"use strict";r.d(t,{Z:()=>j});var n=r(727418),o=r.n(n),a=r(675263),i=r.n(a),c=r(124852),l=r.n(c),s=r(485294),u=r.n(s),p=r(472986),f=r.n(p),d=r(805346);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function w(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(c,e);var t,r,n,a,i=(n=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(n);if(a){var r=E(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return w(this,e)});function c(){var e;h(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return C(O(e=i.call.apply(i,[this].concat(r))),"renderLoading",(function(){return e.props.maskLoading?l().createElement("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"visible",margin:"auto",verticalAlign:"center",left:"0",background:"rgba(255, 255, 255, 0.5)",zIndex:2}},l().createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -40%)"}},l().createElement(d.Z,{msgId:"loading"}),l().createElement(f(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}))):null})),C(O(e),"renderRole",(function(t){return l().Children.toArray(e.props.children).filter((function(e){return e.props.role===t}))})),C(O(e),"hasRole",(function(t){return l().Children.toArray(e.props.children).filter((function(e){return e.props.role===t})).length>0})),C(O(e),"onClickOut",(function(t){e.props.onClickOut&&e.mask===t.target&&e.props.onClickOut(t)})),e}return t=c,(r=[{key:"render",value:function(){var e=this,t=l().createElement("div",{id:this.props.id,style:b({},this.props.style),className:"".concat(this.props.draggable?"modal-dialog-draggable":""," ").concat(this.props.className," modal-dialog-container")},l().createElement("div",{className:this.props.headerClassName+" draggable-header"},this.renderRole("header")),l().createElement("div",{className:this.props.bodyClassName},this.renderLoading(),this.renderRole("body")),this.hasRole("footer")?l().createElement("div",{className:this.props.footerClassName},this.renderRole("footer")):l().createElement("span",null)),r=this.props.draggable?l().createElement(u(),{defaultPosition:this.props.start,bounds:this.props.bounds,handle:".draggable-header, .draggable-header *"},t):t,n=o()({},this.props.style.display?{display:this.props.style.display}:{},this.props.backgroundStyle);return this.props.modal?l().createElement("div",{ref:function(t){e.mask=t},onClick:this.onClickOut,style:n,className:"fade in modal "+this.props.containerClassName,role:"dialog"},r):r}}])&&g(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(l().Component);C(P,"propTypes",{id:i().string.isRequired,style:i().object,backgroundStyle:i().object,className:i().string,maskLoading:i().bool,containerClassName:i().string,headerClassName:i().string,bodyClassName:i().string,footerClassName:i().string,onClickOut:i().func,modal:i().bool,start:i().object,draggable:i().bool,bounds:i().oneOfType([i().string,i().object])}),C(P,"defaultProps",{style:{},backgroundStyle:{background:"rgba(0,0,0,.5)"},start:{x:0,y:150},className:"modal-dialog modal-content",maskLoading:!1,containerClassName:"",headerClassName:"modal-header",bodyClassName:"modal-body",footerClassName:"modal-footer",modal:!1,draggable:!0,bounds:"parent"});const j=P},697909:(e,t,r)=>{"use strict";r.r(t),r.d(t,{TOGGLE_CONTROL:()=>_,default:()=>x});var n=r(124852),o=r.n(n),a=r(727418),i=r.n(a),c=r(171703),l=r(675263),s=r.n(l),u=r(227361),p=r.n(u),f=r(607147),d=r(782904),y=r(757588),m=r(22222),b=r(737275),h=r(807472),g=r(282467),v=r(950966);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function R(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var T=(0,b.u8)("proxyUrl");(0,f.Yq)("prtsc");var _="TOGGLE_CONTROL",A={captureImg:""},I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(c,e);var t,r,n,a,i=(n=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(n);if(a){var r=k(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return R(this,e)});function c(){var e;C(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return N(S(e=i.call.apply(i,[this].concat(r))),"dialogStyle",{position:"fixed",top:"0px",left:"25%",width:"60%"}),N(S(e),"start",{x:.5*(window.innerWidth-600),y:.5*(window.innerHeight-100)}),N(S(e),"setAttributeIgnoreElement",(function(e){switch(e){case"SET":document.getElementById("navigationBar").setAttribute("data-html2canvas-ignore",!0),document.getElementById("mapstore-drawermenu").setAttribute("data-html2canvas-ignore",!0),document.getElementById("mapstore-navbar").setAttribute("data-html2canvas-ignore",!0);break;case"REMOVE":document.getElementById("navigationBar").removeAttribute("data-html2canvas-ignore"),document.getElementById("mapstore-drawermenu").setAttribute("data-html2canvas-ignore"),document.getElementById("mapstore-navbar").setAttribute("data-html2canvas-ignore");break;default:return}})),N(S(e),"onCapture",(function(){e.setAttributeIgnoreElement("SET"),window.html2canvas(document.querySelector(".gn-viewer-layout-body"),{allowTaint:!0,foreignObjectRendering:!0,proxy:T.url}).then((function(t){var r=t.toDataURL("image/png",1).replace("image/png","image/octet-stream");return e.props.onCapture(r)}))})),N(S(e),"onReCapture",(function(){e.setAttributeIgnoreElement("SET"),window.html2canvas(document.querySelector(".gn-viewer-layout-body"),{allowTaint:!0,foreignObjectRendering:!0,proxy:T.url}).then((function(t){var r=t.toDataURL("image/png",1).replace("image/png","image/octet-stream");return e.props.onCapture(r)}))})),N(S(e),"onDownload",(function(){var t=document.createElement("a");t.setAttribute("download","screenshort.png"),t.setAttribute("href",e.props.captureImg),t.click()})),N(S(e),"onClose",(function(){e.props.onClose(!1)})),N(S(e),"addTooltip",(function(t){var r=o().createElement(y.Tooltip,{id:"locate-tooltip"},e.props.tooltip);return o().createElement(v.Z,{placement:e.props.tooltipPlace,key:"overlay-trigger."+e.props.id,overlay:r},t)})),e}return t=c,(r=[{key:"componentDidMount",value:function(){new Promise((function(e,t){var r="html2canvas-api";if(window.document.getElementById(r))e();else{var n=window.document.createElement("script");n.setAttribute("id",r),n.setAttribute("src","https://html2canvas.hertzen.com/dist/html2canvas.min.js"),n.onload=function(){e()},window.document.head.appendChild(n)}}))}},{key:"render",value:function(){return o().createElement("div",null,this.addTooltip(o().createElement(g.Z,{id:this.props.id,style:this.props.style,bsSize:"xsmall",onClick:this.onCapture,className:"square-button",bsStyle:"primary"},o().createElement(y.Glyphicon,{glyph:"camera"}),this.props.text,this.props.help)),this.props.show?o().createElement(h.Z,{draggable:!1,id:"prtsc-dialog",style:this.dialogStyle,start:this.start},o().createElement("div",{key:"header",role:"header"},o().createElement(y.Glyphicon,{glyph:"print"})," Print Screen",o().createElement("button",{key:"close",onClick:this.onClose,className:"close"},o().createElement(y.Glyphicon,{glyph:"1-close"}))),o().createElement("div",{key:"body",role:"body",style:{height:"300px",overflow:"scroll"}},o().createElement("img",{id:"prtsc-img",src:this.props.captureImg,width:"100%"}),o().createElement("div",{className:"prtsc-control mt-2"},o().createElement("button",{className:"btn btn-info",onClick:this.onDownload},"Download"),o().createElement("button",{className:"btn btn-warning",onClick:this.onReCapture},"Re-capture")))):null)}}])&&P(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(o().Component);N(I,"propTypes",{id:s().string,show:s().bool,captureImg:s().string,onDownload:s().func,onReCapture:s().func,onClose:s().func}),N(I,"defaultProps",{show:!1,id:"mapstore-printscreen",captureImg:""});var D=(0,c.connect)((0,m.P1)([function(e){return{show:s().bool,captureImg:e.prtsc.captureImg}},function(e){return function(e){return p()(e,"controls.prtsc.enabled")}(e)}],(function(e,t){return E(E({},e),{},{show:t})})),{onCapture:function(e){return{type:"PRTSC:CAPTURE_SCREEN",capture:e}},onReCapture:function(e){return{type:"PRTSC:RE_CAPTURE_SCREEN",capture:e}},onClose:function(){return{type:_,control:"prtsc",property:null}}},null,{pure:!1})(I);const x={PrintScreenPlugin:i()(D,{BurgerMenu:{name:"prtsc",position:3,panel:!1,help:"help",tooltip:"tooltip",text:"PrintScreen",icon:o().createElement(y.Glyphicon,{glyph:"print"}),action:function(){return(0,d.Xg)("prtsc","enabled",!0)}}}),reducers:{prtsc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PRTSC:CAPTURE_SCREEN":case"PRTSC:RE_CAPTURE_SCREEN":return i()({},e,{captureImg:t.capture});default:return e}}},epics:{}}}}]);