(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[10615],{710615:(e,t,i)=>{"use strict";i.d(t,{Z:()=>z});var r=i(124852),o=i.n(r),n=i(675263),l=i.n(n),a=i(757588),s=i(807654),u=i.n(s),c=i(414293),m=i.n(c),d=i(743129),p=i(993451),v=i(80717),y=i(145869),f=i(680833),b=i(805346),g=i(552259),h=["labelId"];function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,o,n=[],l=!0,a=!1;try{for(i=i.call(e);!(l=(r=i.next()).done)&&(n.push(r.value),!t||n.length!==t);l=!0);}catch(e){a=!0,o=e}finally{try{l||null==i.return||i.return()}finally{if(a)throw o}}return n}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return E(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function w(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function I(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?w(Object(i),!0).forEach((function(t){x(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function x(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var S=(0,p.Z)(["placeholder","noResultsText"])(d.ZP.Creatable),j=(0,p.Z)(["placeholder","noResultsText"])(d.ZP);function R(e){var t,i=e.label,r=e.showArrow,n=e.limitsType;return o().createElement("span",null,(t=i,"scale"===n?"1 : "+Math.round(t):t),r&&o().createElement(o().Fragment,null,"Â ",o().createElement(a.Glyphicon,{glyph:"arrow-left"})))}function T(e){var t=e.id,i=e.value,r=e.placeholderId,n=e.noResultsTextId,l=e.createTextId,a=e.options,s=e.isValidNewOption,c=void 0===s?function(){return!0}:s,m=e.onChange,d=void 0===m?function(){}:m,p=e.disabled,v=e.loading;return o().createElement(S,{inputProps:{id:t},placeholder:r,noResultsText:n,value:i,isLoading:v,options:a,disabled:p,optionRenderer:R,valueRenderer:R,promptTextCreator:function(e){return o().createElement(b.Z,{msgId:l,msgParams:{label:e}})},isValidNewOption:function(e){if(e.label){var t=parseFloat(e.label);return!u()(t)&&c(t)}return!1},onChange:function(e){var t=(null==e?void 0:e.value)&&parseFloat(e.value);d(u()(t)?void 0:I(I({},e),{},{value:t}))}})}function L(e){var t=e.title,i=e.layer,n=e.zoom,l=e.projection,s=e.resolutions,u=void 0===s?(0,g.getResolutions)():s,c=e.defaultLimitsType,d=e.limitsTypesOptions,p=e.dpi,w=e.onChange,x=P((0,r.useState)(c||d[0].value),2),S=x[0],R=x[1],L=i.maxResolution,z=i.minResolution,Z=i.disableResolutionLimits,C=(0,g.dpi2dpu)(p,l);function A(e,t){var i,r=e.map((function(e){return e[S]}));return m()(t[S])||-1!==r.indexOf(t[S])?e:[t].concat((i=e,function(e){if(Array.isArray(e))return E(e)}(i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||O(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).sort((function(e,t){return e[S]>t[S]?-1:1}))}function V(e,t){return(0,g.getResolutionObject)(e,t,{projection:l,resolutions:u})}var F=P((0,r.useState)([]),2),k=F[0],N=F[1],D=P((0,r.useState)(L&&{resolution:L,scale:L*C,zoom:(0,g.getZoomFromResolution)(L,u)}),2),U=D[0],_=D[1],M=P((0,r.useState)(z&&{resolution:z,scale:z*C,zoom:(0,g.getZoomFromResolution)(z,u)}),2),q=M[0],B=M[1],G=P((0,r.useState)(!1),2),W=G[0],$=G[1],H=P((0,r.useState)(),2),J=H[0],K=H[1],Q=P((0,r.useState)(),2),X=Q[0],Y=Q[1],ee=(0,r.useRef)();function te(){Y(void 0),K(void 0)}function ie(e,t){var i,r,o=(i=e,r=t,m()(i)&&m()(r)?"layerProperties.visibilityLimits.serverValuesUpdateUndefined":m()(i)&&!m()(r)?"layerProperties.visibilityLimits.serverValuesUpdateMinScale":!m()(i)&&m()(r)?"layerProperties.visibilityLimits.serverValuesUpdateMaxScale":"layerProperties.visibilityLimits.serverValuesUpdate");K(o)}function re(e,t){e<t&&Y("layerProperties.visibilityLimits.rangeError")}(0,r.useEffect)((function(){return ee.current=!0,function(){ee.current=!1}}),[]);var oe=u.join(",");return(0,r.useEffect)((function(){var e=z&&{resolution:z,scale:z*C,zoom:(0,g.getZoomFromResolution)(z,u)},t=L&&{resolution:L,scale:L*C,zoom:(0,g.getZoomFromResolution)(L,u)},i=[e,t].filter((function(e){return e})).reduce(A,u.map((function(e,t){return{resolution:e,scale:e*C,zoom:t}})));_(t),B(e),N(i),te()}),[C,oe]),(0,r.useEffect)((function(){!ee.current||m()(L)&&m()(z)||(ie(L,z),re(L,z))}),[ee]),o().createElement("div",{className:"ms-visibility-limits-form"},o().createElement("div",{className:"ms-visibility-limits-form-title",style:{display:"flex",alignItems:"center"}},o().createElement("div",{style:{flex:1}},t),o().createElement(v.Z,{btnDefaultProps:{className:"square-button-md no-border"},buttons:[{glyph:"refresh",disabled:!(!Z&&!W),visible:"wms"===i.type,onClick:function(){"wms"!==i.type||W||($(!0),te(),(0,f.kB)(i).toPromise().then((function(e){if(ee.current){var t,i,r=e.maxScaleDenominator,o=e.minScaleDenominator,n=!m()(r)&&V(r,"scale"),l=!m()(o)&&V(o,"scale");ie(r,o),l&&B(l),n&&_(n),w(I(I({},n&&{maxResolution:n.resolution}),l&&{minResolution:l.resolution}));var a=(null===(t=l||q)||void 0===t?void 0:t.resolution)||-1/0;re((null===(i=n||U)||void 0===i?void 0:i.resolution)||1/0,a),$(!1)}})).catch((function(){ee.current&&($(!1),Y("layerProperties.visibilityLimits.serverValuesError"))})))},tooltipId:"layerProperties.visibilityLimits.updateWMSCapabilities"},{Element:function(){return o().createElement(y.Z,{checked:!Z,onClick:function(){w({disableResolutionLimits:!Z}),te()}})}}]})),o().createElement("label",{htmlFor:"ms-visibility-limits-max"},o().createElement(b.Z,{msgId:"layerProperties.visibilityLimits.maxValue"})),o().createElement(T,{id:"ms-visibility-limits-max",value:(null==U?void 0:U[S])&&{value:U[S],label:U[S],zoom:U.zoom,limitsType:S},placeholderId:"layerProperties.visibilityLimits.maxValuePlaceholder",noResultsTextId:"layerProperties.visibilityLimits.valueNoResultsText",createTextId:"layerProperties.visibilityLimits.createOption",loading:W,isValidNewOption:function(e){return e>=((null==q?void 0:q[S])||0)},options:k.map((function(e){return I(I({},e),{},{value:e[S]+(e.delta||0),label:e[S],showArrow:e.zoom===n,disabled:!m()(null==q?void 0:q[S])&&e[S]<=q[S],limitsType:S})})),disabled:Z||W,onChange:function(e){var t=void 0===e.value?{}:m()(e.zoom)?V(e.value,S):{resolution:e.resolution,scale:e.scale,zoom:e.zoom};if(w({maxResolution:t.resolution}),_(t),void 0!==e.value&&m()(e.zoom)){var i=A(k,t);N(i)}te()}}),o().createElement("label",{htmlFor:"ms-visibility-limits-min"},o().createElement(b.Z,{msgId:"layerProperties.visibilityLimits.minValue"})),o().createElement(T,{id:"ms-visibility-limits-min",value:(null==q?void 0:q[S])&&{value:q[S],label:q[S],zoom:q.zoom,limitsType:S},placeholderId:"layerProperties.visibilityLimits.minValuePlaceholder",noResultsTextId:"layerProperties.visibilityLimits.valueNoResultsText",createTextId:"layerProperties.visibilityLimits.createOption",loading:W,isValidNewOption:function(e){return e<=((null==U?void 0:U[S])||1/0)},options:k.map((function(e){return I(I({},e),{},{value:e[S],label:e[S],showArrow:e.zoom===n,disabled:!m()(null==U?void 0:U[S])&&e[S]>=U[S],limitsType:S})})),disabled:Z||W,onChange:function(e){var t=void 0===e.value?{}:m()(e.zoom)?V(e.value,S):{resolution:e.resolution,scale:e.scale,zoom:e.zoom};if(w({minResolution:t.resolution}),B(t),void 0!==e.value&&m()(e.zoom)){var i=A(k,t);N(i)}te()}}),o().createElement("label",{htmlFor:"ms-visibility-limits-type"},o().createElement(b.Z,{msgId:"layerProperties.visibilityLimits.type"})),o().createElement(j,{inputProps:{id:"ms-visibility-limits-type"},value:S,clearable:!1,options:d.map((function(e){var t=e.labelId;return I(I({},function(e,t){if(null==e)return{};var i,r,o=function(e,t){if(null==e)return{};var i,r,o={},n=Object.keys(e);for(r=0;r<n.length;r++)i=n[r],t.indexOf(i)>=0||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)i=n[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,h)),t&&{label:o().createElement(b.Z,{msgId:t})})})),disabled:Z||W,onChange:function(e){var t=e.value;R(t),te()}}),J&&o().createElement(a.Alert,{bsStyle:"success"},o().createElement(b.Z,{msgId:J})),X&&o().createElement(a.Alert,{bsStyle:"danger"},o().createElement(b.Z,{msgId:X})))}L.propTypes={layer:l().object,zoom:l().number,onChange:l().func,resolutions:l().array,limitsTypesOptions:l().array,projection:l().string,dpi:l().number,defaultLimitsType:l().string},L.defaultProps={layer:{},onChange:function(){},limitsTypesOptions:[{value:"scale",labelId:"layerProperties.visibilityLimits.scale"},{value:"resolution",labelId:"layerProperties.visibilityLimits.resolution"}],dpi:g.DEFAULT_SCREEN_DPI};const z=L}}]);