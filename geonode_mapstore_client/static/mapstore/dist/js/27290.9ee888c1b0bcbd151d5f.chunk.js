(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[27290],{989077:(e,n,t)=>{"use strict";t.d(n,{Yf:()=>ve,Lz:()=>Ae,LR:()=>he,RP:()=>xe,cX:()=>Oe,bf:()=>Se,UC:()=>Pe,zr:()=>Ce,BP:()=>je,N:()=>Ne,IN:()=>Te,xp:()=>Ee,jU:()=>be,mr:()=>we});var r=t(178598),o=t.n(r),a=t(997995),i=t.n(a),u=t(279003),c=t.n(u),l=t(489597),s=t.n(l),m=t(966085),f=t.n(m),p=t(882702),d=t(727418),y=t.n(d),g=t(972163),v=t(505055),b=t(3674),h=t.n(b),x=t(252628),w=t.n(x),S=t(227361),O=t.n(S),E=t(91175),j=t.n(E),C=t(66604),N=t.n(C),P=t(187185),T=t.n(P),A=(t(630998),t(478718),t(218721)),k=t.n(A),B=(t(493220),t(423570)),L=t.n(B),F=t(957557),D=t.n(F),I=t(747037),R=t.n(I),z=t(385564),M=t.n(z);function _(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,a=[],i=!0,u=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(u)throw o}}return a}}(e,n)||q(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function G(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$(Object(t),!0).forEach((function(n){J(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function J(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function U(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,n){if(e){if("string"==typeof e)return X(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?X(e,n):void 0}}function X(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}t(313311),t(406557);var H=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,r=O()(n,"childObject",n);return h()(r).filter((function(e){return"$"!==e&&"_"!==e&&"$ns"!==e})).reduce((function(n,o){return[].concat(U(n),U(M()(r[o].map((function(n){var r=O()(n,"$ns",{});return r.uri!==e||r.local!==t?[]:[{params:O()(n,"$",{}),charContent:O()(n,"_"),childObject:D()(n,"$","_","$ns")}]})))))}),[])},W=function(e,n,t){return j()(H(e,n,t))},V=function(e,n,t){return w()(O()(n,"params",{})).reduce((function(n,r){return n||r.local===t&&r.uri===e&&r.value}),void 0)},Y=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return w()(O()(e,"params",{})).reduce((function(e,n){var r=t.reduce((function(e,t){var r=R()(t)?{local:t,paramName:t,uri:""}:t,o=r.local,a=r.uri,i=r.paramName;return e||o===n.local&&a===n.uri&&i}),null);return r?G(G({},e),{},J({},r,n.value)):e}),{})},Z=function(e,n,t,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return M()([[[/\&/g,"&amp;"]],e?[]:[[/\"/g,"&quot;"]],n?[]:[[/\'/g,"&apos;"]],t?[]:[[/\>/g,"&gt;"]],r?[]:[[/\</g,"&lt;"]]]).reduce((function(e,n){var t=_(n,2),r=t[0],o=t[1];return e.replace(r,o)}),o)};function K(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,a=[],i=!0,u=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(u)throw o}}return a}}(e,n)||ee(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,n){if(e){if("string"==typeof e)return ne(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ne(e,n):void 0}}function ne(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function te(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function re(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?te(Object(t),!0).forEach((function(n){oe(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):te(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function oe(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}Z.bind(null,!0,!0,!0,!1),Z.bind(null,!1,!1,!0,!1),t(624262),t(986267);var ae={maxExtent:[0,0,1e4,1e4],projection:"EPSG:900913",layerType:"wms"},ie={ns:"http://www.opengis.net/context"},ue={ns:"http://www.w3.org/1999/xlink",prefix:"xlink"},ce={ns:"http://openlayers.org/context",prefix:"ol"},le={ns:"http://geo-solutions.it/mapstore/context",prefix:"ms"},se={group:"background",id:"empty_background",source:"ol",title:"Empty Background",type:"empty",visibility:!0},me=function(e){return"OGC:WMS"===e?"wms":ae.layerType},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=e.toLowerCase();return"true"===n||"1"===n},pe=function(e){return h()(e).filter((function(n){return void 0!==e[n]})).reduce((function(n,t){return re(re({},n),{},oe({},t,e[t]))}),{})},de=function(e){return!!(e&&e.minx&&e.miny&&e.maxx&&e.maxy)},ye=function(e){return!!(e&&de(e.bounds)&&e.crs)},ge=new DOMParser,ve={avi:"video/avi",gpx:"application/gpx+xml",kmz:"application/vnd.google-earth.kmz",kml:"application/vnd.google-earth.kml+xml",zip:"application/zip",json:"application/json",geojson:"application/json",wmc:"application/vnd.wmc"},be=function(e){return e.split(".").slice(-1)[0]},he=function(e,n,t){var r=new Blob([e],{type:t});o().saveAs(r,n)},xe=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"snapshot.png",t=arguments.length>2?arguments[2]:void 0;he(i()(e),n,t)},we=function(e){return[].concat(c().parseZip(e))},Se=function(e){var n=function(e){return[].slice.call(e.documentElement.getElementsByTagName("StyleMap")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("Style")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("LineStyle")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("PointStyle")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("PolyStyle")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("IconStyle")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("LabelStyle")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("ListStyle")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("BallonStyle")).map((function(e){return e.parentNode.removeChild(e)})),[].slice.call(e.documentElement.getElementsByTagName("styleUrl")).map((function(e){return e.parentNode.removeChild(e)})),e}(e);return[].concat(s().kml(n)).map((function(e){return y()({},e,{fileName:n.getElementsByTagName("name")[0].innerHTML})}))},Oe=function(e,n){return[].concat(s().gpx(e)).map((function(t){return y()({},t,{fileName:e.getElementsByTagName("name")[0]&&e.getElementsByTagName("name")[0].innerHTML||n})}))},Ee=function(e){return new p.Promise((function(n,t){var r=new FileReader;r.onload=function(){n(r.result)},r.onerror=function(){t(r.error.name)},r.readAsArrayBuffer(e)}))},je=function(e){return new p.Promise((function(n,t){var r=new FileReader;r.onload=function(){n(ge.parseFromString(r.result,"text/xml"))},r.onerror=function(){t(r.error.name)},r.readAsText(e)}))},Ce=function(e){return new p.Promise((function(n,t){var r=new FileReader;r.onload=function(){try{n(JSON.parse(r.result))}catch(e){t(e)}},r.onerror=function(){t(r.error.name)},r.readAsText(e)}))},Ne=function(e){var n=new(f());return new p.Promise((function(t,r){n.loadAsync(e).then((function(e){e.filter((function(e){return-1!==e.indexOf("kml")})).forEach((function(e){return e.async("string").then((function(e){t(ge.parseFromString(e,"text/xml"))})).catch((function(e){r(e.message)}))}))}))}))},Pe=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new p.Promise((function(t,r){var o=new FileReader;o.onload=function(){try{var e=JSON.parse(o.result);t({geoJSON:e,errors:(0,g.$)(e).filter((function(e){return n||"message"!==e.level}))})}catch(e){r(e)}},o.onerror=function(){r(o.error.name)},o.readAsText(e)}))},Te=function(e){return new p.Promise((function(n,t){var r=new FileReader;r.onload=function(){(function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=new v.Parser({explicitRoot:!1,xmlns:!0});return new Promise((function(r){t.parseString(e,(function(e,t){if(e)throw new Error("General XML parsing error");var o=W.bind(null,ie.ns),a=H.bind(null,ie.ns),i=W.bind(null,ce.ns),u=W.bind(null,le.ns),c=H.bind(null,le.ns),l=V.bind(null,""),s=V.bind(null,ue.ns),m=function(e){var n,t=Y(e,"name","type"),r=t.name,o=t.type;switch(o){case"number":n=parseFloat(e.charContent);break;case"object":n=JSON.parse(e.charContent);break;case"boolean":n=fe(e.charContent);break;default:n=e.charContent}return{name:r,type:o,value:n}},f=o({root:[t]},"ViewContext"),p=o(f,"General"),d=o(f,"LayerList"),y=l(f,"version");if(!f||!y)throw new Error("Not a WMC file!");var g=O()(o(p,"Title"),"charContent"),v=o(p,"Extension"),b=i(v,"maxExtent"),h=o(p,"BoundingBox"),x=N()(b&&Y(b,"minx","miny","maxx","maxy")||Y(h,"minx","miny","maxx","maxy"),parseFloat),w=de(x)&&[x.minx,x.miny,x.maxx,x.maxy]||ae.maxExtent,S=l(h,"SRS")||ae.projection,E={bounds:N()(Y(h,"minx","miny","maxx","maxy"),parseFloat),crs:l(h,"SRS")},C=ye(E)?E:void 0,P=n?L()():void 0,A=a(d,"Layer").map((function(e){var n=o(e,"Extension"),t=o(e,"Server"),r=j()(a(o(e,"StyleList"),"Style").filter((function(e){return fe(l(e,"current"))}))),m=O()(i(n,"transparent"),"charContent"),f=O()(i(n,"opacity"),"charContent"),p={maxExtent:N()(Y(i(n,"maxExtent"),"minx","maxx","miny","maxy"),parseFloat),tileSize:N()(Y(i(n,"tileSize"),"width","height"),parseInt),transparent:m&&fe(m),isBaseLayer:fe(O()(i(n,"isBaseLayer"),"charContent")),singleTile:fe(O()(i(n,"singleTile"),"charContent")),opacity:f&&parseFloat(f)},d=u(n,"search"),y=c(u(n,"DimensionList"),"Dimension"),g=O()(u(n,"filter"),"charContent"),v={group:O()(u(n,"group"),"charContent"),search:d&&{url:s(d,"href"),type:l(d,"type")},dimensions:y.map((function(e){return{name:l(e,"name"),source:{type:l(e,"type"),url:s(e,"href")}}})),filter:g&&function(){try{return JSON.parse(g)}catch(e){return null}}()||void 0},b=a(o(e,"DimensionList"),"Dimension").map((function(e){return{name:l(e,"name"),units:l(e,"units"),unitSymbol:l(e,"unitSymbol"),default:l(e,"default"),values:O()(e,"charContent","").split(",")}})),h={id:L()(),visibility:!fe(l(e,"hidden")),type:me(l(t,"service")),url:s(o(t,"OnlineResource"),"href"),name:O()(o(e,"Name"),"charContent"),title:O()(o(e,"Title"),"charContent"),format:O()(j()(a(o(e,"FormatList"),"Format").filter((function(e){return fe(l(e,"current"))}))),"charContent"),style:O()(o(r,"Name"),"charContent"),singleTile:p.singleTile,queryable:fe(l(e,"queryable")),bbox:de(p.maxExtent)?{bounds:p.maxExtent,crs:S}:void 0,group:v.group||(p.isBaseLayer?"background":P),opacity:p.opacity,search:v.search,layerFilter:v.filter,dimensions:T()([].concat(Q(v.dimensions),Q(b)),(function(e,n){return e.name===n.name}))};return re(re({},pe(h)),{},{params:pe(h.params)})})),B=[].concat(Q(A.filter((function(e){return"background"===e.group}))),Q(A.filter((function(e){return"background"!==e.group})))),F=0===B.filter((function(e){return"background"===e.group&&e.visibility})).length?[se].concat(Q(B)):B,D=u(v,"GroupList"),I=c(D,"Group").map((function(e){return{id:l(e,"id"),title:l(e,"title"),expanded:fe(l(e,"expanded"))}})),R=D&&I||[].concat(Q(F.filter((function(e){return!e.group||"Default"===e.group})).length>0?[{id:"Default",title:"Default",expanded:!0}]:[]),Q(n?[{id:P,title:g||P}]:[])),z=u(v,"center"),M=re(re({},N()(Y(z,"x","y"),parseFloat)),{},{crs:l(z,"crs")}),_=parseFloat(O()(u(v,"zoom"),"charContent")),$=u(v,"CatalogServices"),G=l($,"selectedService"),J=c($,"Service").map((function(e){return[l(e,"serviceName"),c(e,"Attribute")]})).reduce((function(e,n){var t=K(n,2),r=t[0],o=t[1];return re(re({},e),{},oe({},r,o.map(m).reduce((function(e,n){var t=n.name,r=n.value;return re(re({},e),{},oe({},t,r))}),{})))}),{}),U={catalogServices:$&&{selectedService:G,services:J},map:{maxExtent:w,bbox:_?void 0:C,projection:S,backgrounds:[],groups:R,layers:F,center:k()(M,"x","y","crs")?M:void 0,zoom:_},version:2};r(U)}))}))})(r.result,!0).then((function(e){return n(e)})).catch((function(e){return t(e)}))},r.onerror=function(){t(r.error.name)},r.readAsText(e)}))},Ae=function(e){var n=new(f());return new p.Promise((function(t){n.loadAsync(e).then((function(e){var n=e.files,r=void 0===n?{}:n,o=Object.keys(r).filter((function(e){return!r[e].dir&&0!==e.indexOf("__MACOSX")&&e.indexOf(".shp")===e.length-4})).map((function(e){return e.slice(0,-4)})).reduce((function(e,n){return e.concat(!r["".concat(n,".prj")]&&n||[])}),[]);t(o)}))}))}},272810:()=>{},486799:()=>{}}]);