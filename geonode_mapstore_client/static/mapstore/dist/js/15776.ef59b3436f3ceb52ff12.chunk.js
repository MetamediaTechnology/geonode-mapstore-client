(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[15776],{993451:(e,r,t)=>{"use strict";t.d(r,{Z:()=>w});var n=t(86638),o=t(675263),a=t.n(o),u=t(984596),i=t.n(u),l=t(701469),f=t.n(l),c=t(414293),s=t.n(c),p=t(747037),d=t.n(p),y=t(867076),b=["messages"];function m(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?h(Object(t),!0).forEach((function(r){g(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function g(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var O=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label";if(f()(r))return r.map((function(o){var a=(0,n.S$)(e,o[t]||d()(o)&&o||"");return v(v({},o),{},g({},t,s()(a)?r:a))}));var o=(0,n.S$)(e,r);return s()(o)?r:o},E=function(e,r,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;return v(v({},n),{},g({},o,e[o]&&O(r,e[o],t)))}};const w=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"label";return(0,y.compose)((0,y.getContext)({messages:a().object}),(0,y.mapProps)((function(t){var n=t.messages,o=m(t,b);return v(v({},o),i()(e).reduce(E(o,n,r),{}))})))}},915776:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>be});var n=t(675263),o=t.n(n),a=t(124852),u=t.n(a),i=t(171703),l=t(607147),f=t(22222),c=t(727418),s=t.n(c),p=t(227361),d=t.n(p),y=t(782904),b="BUFFER:SET_LAYER",m="BUFFER:SET_RADIUS",h="BUFFER:SET_UNIT",v="BUFFER:DO_BUFFER",g="BUFFER:ADD_AS_LAYER",O="BUFFER:SET_LOADING",E="BUFFER:FETCH_FAILURE",w="TOGGLE_CONTROL",j=function(e){return{type:b,index:e}},S=function(e){return{type:m,radius:e}},C=function(e){return{type:g,bufferedFtCollection:e}},P=function(e){return{type:O,isLoading:e}},x=function(e){return{type:E,error:e}},I=t(49977),A=t.n(I),F=t(423570),R=t.n(F),L=t(580416),k=t(805346),B=t(47805),_=t(333567),U=t(375875),T=t.n(U),D=t(929346);function N(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var V="",Z=function(e){return e?function(r,t){var n=function(e){var n=function(e,t){var n=e,o=t;if(resizeBy<=0)return r(x(u().createElement(k.Z,{msgId:"bufferPlugin.errorLessThan1"}))),void r(P(!1));switch(o){case"meters":n/=1e3,o="kilometers";break;case"วา":n/=500,o="kilometers";break;default:removeEventListener}return[n,o]}(t().buffer.radius,t().buffer.unitValue);if(void 0!==n){var o=[];e.features.forEach((function(e){e.id?o.push(e.id):e.properties.id&&o.push(e.properties.id)}));var a=(0,_.Z)(e,n[0],{units:n[1]});return a.features.forEach((function(e,r){e.id="buffered_"+o[r],e.properties.id&&(e.properties.id="buffered_"+o[r])})),a}};if(r(P(!0)),V=e.title||e.name,e.features){var o;o="Annotations"===V?function(e){for(var r=[],t=0;t<e.features.length;t++)for(var n=0;n<e.features[t].features.length;n++)r.push(e.features[t].features[n]);return r}(e):e.features;var a=(0,D.uf)(o),i=n(a);if(void 0===i)return;r(C(i)),r(x("succeed")),r(j(-1)),r(P(!1)),r(S(1))}else new Promise((function(r){var t={service:"WFS",version:e.version,request:"GetFeature",typeName:e.name,outputFormat:"application/json"};if(e.layerFilter){var n=(0,B.toCQLFilter)(null==e?void 0:e.layerFilter);t.cql_filter=n}r(T().get("".concat(e.url||"/geoserver/wfs"),{params:t}))})).then((function(e){var t=e.data,o=n(t);void 0!==o&&(r(C(o)),r(x("succeed")),r(j(-1)),r(P(!1)),r(S(1)))})).catch((function(e){console.error(e),r(P(!1)),r(x(u().createElement(k.Z,{msgId:"bufferPlugin.errorFetch"})))}))}:function(e){e(x(u().createElement(k.Z,{msgId:"bufferPlugin.noLayer"})))}},G={radius:1,layerIndex:-1,unitValue:"kilometers",loading:!1,error:""},M=t(807472),W=t(200020),$=t(757588),q=t(675110),z=t(743129),Y=t(441609),H=t.n(Y);function K(){return K=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},K.apply(this,arguments)}function Q(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a=[],u=!0,i=!1;try{for(t=t.call(e);!(u=(n=t.next()).done)&&(a.push(n.value),!r||a.length!==r);u=!0);}catch(e){i=!0,o=e}finally{try{u||null==t.return||t.return()}finally{if(i)throw o}}return a}}(e,r)||function(e,r){if(e){if("string"==typeof e)return X(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?X(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var J=(0,t(993451).Z)(["placeholder","clearValueText","noResultsText"])(z.ZP),ee=function(e){var r=e.responses,t=e.index,n=e.setIndex,o=Q((0,a.useState)([]),2),i=o[0],l=o[1],f=Q((0,a.useState)(""),2),c=f[0],s=f[1];return(0,a.useEffect)((function(){H()(r)||l(r.map((function(e,r){var t=(null==e?void 0:e.title)||(null==e?void 0:e.name);return{label:t,value:t,idx:r,style:{display:"block"}}})))}),[r]),(0,a.useEffect)((function(){var e,n;s((null===(e=r[t])||void 0===e?void 0:e.title)||(null===(n=r[t])||void 0===n?void 0:n.name)||"")}),[r,t]),u().createElement("div",{id:"identify-layer-select",style:{flex:"1 1 0%"}},u().createElement(J,K({},{clearable:!1,isSearchable:!0},{onChange:function(e){var r=(null==e?void 0:e.idx)||0;n(r)},value:c||"",options:i,noResultsText:"identifyLayerSelectNoResult"})))};ee.defaultProps={responses:[],index:-1},ee.propTypes={responses:o().array,setIndex:o().func,index:o().number};const re=ee;function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function oe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ne(Object(t),!0).forEach((function(r){se(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ae(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ue(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e,r){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},ie(e,r)}function le(e,r){if(r&&("object"===te(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return fe(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}function se(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function pe(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}(0,l.Yq)("buffer");var de=function(e){!function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&ie(e,r)}(i,e);var r,t,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=ce(n);if(o){var t=ce(this).constructor;e=Reflect.construct(r,arguments,t)}else e=r.apply(this,arguments);return le(this,e)});function i(){var e;ae(this,i);for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return se(fe(e=a.call.apply(a,[this].concat(t))),"dialogStyle",{position:"fixed",top:"0px",left:"0px",width:"500px"}),se(fe(e),"start",{x:.5*(window.innerWidth-600),y:.5*(window.innerHeight-100)}),se(fe(e),"onClose",(function(){e.props.onClose(!1)})),se(fe(e),"onLayerChange",(function(r){e.props.onChangeLayer(r)})),se(fe(e),"onDoBuffer",(function(){e.props.onDoBuffer(e.props.layersNode[e.props.layerIndex])})),se(fe(e),"onChangeUnit",(function(r){e.props.onChangeUnit(r)})),se(fe(e),"onChangeRadius",(function(r){var t=r<0?0:r;e.props.onChangeRadius(Number(t))})),se(fe(e),"onReset",(function(){e.props.onChangeLayer(-1)})),e}return r=i,(t=[{key:"render",value:function(){var e=this;return this.props.show?u().createElement(M.Z,{Dialog:!0,id:"buffer-dialog",style:null==this?void 0:this.dialogStyle,start:null==this?void 0:this.start},u().createElement("div",{key:"header",role:"header"},u().createElement($.Glyphicon,{glyph:"folder-open"})," ",u().createElement(k.Z,{msgId:"bufferPlugin.title"}),u().createElement("button",{key:"close",onClick:this.onClose,className:"close"},u().createElement($.Glyphicon,{glyph:"1-close"}))),u().createElement("div",{key:"body",role:"body"},u().createElement("p",null,u().createElement(k.Z,{msgId:"bufferPlugin.layerLabel"})),u().createElement(re,{responses:this.props.layersNode,index:this.props.layerIndex,setIndex:this.onLayerChange}),u().createElement("br",null),u().createElement("p",null,u().createElement(k.Z,{msgId:"bufferPlugin.bufferLabel"})),u().createElement($.Row,null,u().createElement($.Col,{md:6,sm:6},u().createElement("input",{style:{height:"34px"},required:!0,type:"text",onKeyPress:"return (event.charCode !=8 && event.charCode ==0 || ( event.charCode == 46 || (event.charCode >= 48 && event.charCode <= 57)))",className:"form-control",id:"buffer-size",onChange:function(r){return e.onChangeRadius(r.nativeEvent.target.value)},value:this.props.radius>=0?this.props.radius:""})),u().createElement($.Col,{md:6,sm:6},u().createElement(W.DropdownList,{id:"bufferUnitValues",data:this.props.bufferUnitValues,dataKey:"value",textField:"label",valueField:"value",defaultValue:this.props.bufferUnitValues[0],onChange:function(r){return e.onChangeUnit(r.value)}}))),u().createElement("br",null),u().createElement("div",{style:{display:"flex"}},u().createElement("br",null),this.props.loading?u().createElement("button",{key:"buffer-loading",className:"btn btn-outline-info",style:{minWidth:"100px"},disabled:!0},u().createElement(k.Z,{msgId:"bufferPlugin.loading"})):u().createElement("button",{key:"buffer-save",className:"btn btn-outline-info",style:{minWidth:"100px"},onClick:this.onDoBuffer},u().createElement(k.Z,{msgId:"bufferPlugin.button"})),u().createElement("button",{key:"buffer-clear",onClick:this.onReset,className:"btn btn-outline",style:{minWidth:"90px",marginRight:"5px"}},u().createElement(k.Z,{msgId:"bufferPlugin.resetButton"}))),u().createElement("br",null),"succeed"===this.props.error?u().createElement("span",{style:{color:"green"}},u().createElement(k.Z,{msgId:"bufferPlugin.successText"})):u().createElement("span",{style:{color:"red"}},this.props.error))):null}}])&&ue(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),i}(u().Component);se(de,"propTypes",{show:o().bool,radius:o().number,bufferLengthValue:o().array,layersNode:o().array,layersGroups:o().array,layerIndex:o().number,unitValue:o().string,loading:o().bool,error:o().string,onClose:o().func,onChangeLayer:o().func,onChangeUnit:o().func,onDoBuffer:o().func}),se(de,"defaultProps",{show:!1,bufferUnitValues:[{value:"kilometers",label:"km"},{value:"meters",label:"m"},{value:"วา",label:"วา"},{value:"miles",label:"miles"},{value:"degrees",label:"degrees"}],radius:1,layersNode:[],layersGroups:[],layerIndex:-1,unitValue:"",error:"",onClose:function(){},onChangeLayer:function(){},onChangeUnit:function(){},onDoBuffer:function(){}});var ye=(0,i.connect)((0,f.P1)([function(e){return{layerIndex:e.buffer.layerIndex,unitValue:e.buffer.unitValue,radius:e.buffer.radius,featuresSelected:e.buffer.featuresSelected,bufferedFeatures:e.buffer.bufferedFeatures,loading:e.buffer.loading,error:e.buffer.error}},function(e){return function(e){return d()(e,"controls.buffer.enabled")}(e)},q.Bt],(function(e,r,t){return oe(oe({},e),{},{show:r,layersGroups:t,layersNode:(n=t,o=[],n.map((function(e){var r;o.push.apply(o,function(e){if(Array.isArray(e))return pe(e)}(r=e.nodes)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,r){if(e){if("string"==typeof e)return pe(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?pe(e,r):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})),o)});var n,o})),{onClose:function(){return{type:w,control:"buffer",property:null,layerSelected:{},layerIndex:-1,loading:!1,error:""}},onChangeLayer:j,onChangeUnit:function(e){return{type:h,unitValue:e}},onChangeRadius:S,onDoBuffer:function(e){return{type:v,layerSelected:e}}},null,{pure:!1})(de);const be={BufferPlugin:s()(ye,{BurgerMenu:{name:"buffer",position:10,panel:!1,help:"help",tooltip:"tooltip",text:"Buffer",icon:u().createElement($.Glyphicon,{glyph:"resize-full"}),action:function(){return(0,y.Xg)("buffer","enabled",!0)}}}),reducers:{buffer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case b:return s()({},e,{layerIndex:r.index});case h:return s()({},e,{unitValue:r.unitValue});case m:return s()({},e,{radius:r.radius});case O:return s()({},e,{loading:r.isLoading});case E:return s()({},e,{error:r.error});case w:return s()({},e,{layerSelected:r.layerSelected,layerIndex:r.layerIndex,loading:r.loading,error:r.error});default:return e}}},epics:{doBufferEpic:function(e,r){var t=r.getState,n=void 0===t?function(){}:t;return e.ofType(v).filter((function(){return(n().controls.buffer||{}).enabled||!1})).switchMap((function(e){var r=e.layerSelected;return A().Observable.from([Z(r)])}))},addAsBufferedLayerEpic:function(e){return e.ofType(g).switchMap((function(e){var r,t=e.bufferedFtCollection;return A().Observable.of((0,L.A4)({type:"vector",id:R()(),name:"BufferedLayer",hideLoading:!0,features:(r=t.features,function(e){if(Array.isArray(e))return N(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,r){if(e){if("string"==typeof e)return N(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?N(e,r):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),visibility:!0,title:"Buffered_"+V}))}))}}}}}]);